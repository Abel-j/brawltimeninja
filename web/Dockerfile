FROM node:16

ARG CLICKER_URL
ENV CLICKER_URL=$CLICKER_URL
ARG RENDER_URL
ENV RENDER_URL=$RENDER_URL
ARG MEDIA_URL
ENV MEDIA_URL=$MEDIA_URL
ARG CUBE_URL
ENV CUBE_URL=$CUBE_URL
ARG API_URL
ENV API_URL=$API_URL
ARG SENTRY_DSN=''
ENV SENTRY_DSN=$SENTRY_DSN
ARG SENTRY_ORG=''
ENV SENTRY_ORG=$SENTRY_ORG
ARG SENTRY_PROJECT=''
ENV SENTRY_PROJECT=$SENTRY_PROJECT
ARG SENTRY_AUTH_TOKEN=''
ENV SENTRY_AUTH_TOKEN=$SENTRY_AUTH_TOKEN

WORKDIR /app
ENV PORT=80
EXPOSE 80

COPY . .
RUN yarn install --frozen-lockfile && yarn run build

ENV NODE_ENV=production
CMD [ "yarn", "run", "start" ]
